> #### Run IMIS algorithm ####
> l_fit_imis <- IMIS(B = 1000,      # n_samp = B*10 (was 100 incremental sample size at each iteration of IMIS)
+                    B.re = n_resamp,      # "n_resamp" desired posterior sample size
+                    number_k = 500,      # maximum number of iterations in IMIS (originally 10)
+                    D = 0) # originally 0
[1] "10000 likelihoods are evaluated in 155.57 minutes"
[1] "Stage   MargLike   UniquePoint   MaxWeight   ESS"
[1]   1.000   4.734 135.198   0.094  28.911
[1]   2.000   4.688 217.254   0.057  57.056
[1]   3.000   4.631 273.751   0.045  73.286
[1]   4.000   4.572 314.456   0.036  87.573
[1]   5.000   4.545 378.985   0.032 103.247
[1]   6.000   4.518 423.109   0.026 121.838
[1]   7.000   4.472 476.167   0.025 140.119
[1]   8.000   4.502 533.507   0.019 161.419
[1]   9.000   4.466 602.842   0.018 183.815
[1]  10.000   4.477 665.896   0.015 214.196
[1]  11.000   4.457 747.114   0.015 232.958
[1]  12.000   4.467 810.855   0.037 206.120
[1]  13.000   4.494 880.430   0.014 299.418
[1]  14.000   4.530 934.210   0.012 328.814
[1]  15.000   4.537 974.369   0.009 360.808
[1]   16.000    4.517 1017.655    0.009  388.703
[1]   17.000    4.505 1053.991    0.009  410.633
[1]   18.000    4.505 1157.093    0.008  481.171
[1]   19.000    4.506 1202.032    0.007  513.067
[1]   20.000    4.528 1292.928    0.007  582.737
[1]   21.000    4.522 1339.209    0.007  615.447
[1]   22.000    4.523 1431.876    0.005  673.402
[1]   23.000    4.563 1488.435    0.020  571.732
[1]   24.000    4.572 1567.284    0.006  750.396
[1]   25.000    4.573 1684.491    0.005  811.167
[1]   26.000    4.581 1739.983    0.004  845.204
[1]   27.000    4.578 1765.667    0.004  864.113
[1]   28.000    4.581 1852.521    0.005  905.726
[1]   29.000    4.593 1948.426    0.004  955.364
[1]   30.000    4.589 2038.995    0.006 1001.865
[1]   31.000    4.597 2142.408    0.004 1073.878
[1]   32.000    4.598 2224.802    0.004 1144.462
[1]   33.000    4.599 2286.311    0.003 1198.990
[1]   34.000    4.602 2356.051    0.003 1238.866
[1]   35.000    4.606 2455.002    0.003 1311.837
[1]   36.000    4.615 2523.796    0.003 1409.260
[1]   37.000    4.613 2563.659    0.003 1448.576
[1]   38.000    4.615 2641.614    0.003 1493.759
[1]   39.000    4.617 2693.669    0.003 1543.615
[1]   40.000    4.622 2771.996    0.003 1636.689
[1]   41.000    4.627 2826.627    0.002 1698.347
[1]   42.000    4.623 2875.576    0.002 1751.270
[1]   43.000    4.625 2929.843    0.002 1808.952
[1]   44.000    4.624 2964.212    0.002 1854.362
[1]   45.000    4.619 3027.659    0.002 1930.703
[1]   46.000    4.634 3116.898    0.003 2010.994
[1]   47.000    4.628 3174.629    0.002 2090.585
[1]   48.000    4.627 3235.713    0.002 2167.573
[1]   49.000    4.624 3285.058    0.002 2239.700
[1]   50.000    4.625 3301.717    0.002 2264.776
[1]   51.000    4.637 3354.744    0.003 2309.025
[1]   52.000    4.635 3421.793    0.002 2457.897
[1]   53.000    4.639 3493.950    0.002 2540.336
[1]   54.000    4.644 3539.003    0.002 2607.372
[1]   55.000    4.647 3572.775    0.002 2654.762
[1]   56.000    4.643 3643.102    0.002 2748.412
[1]   57.000    4.643 3674.325    0.001 2782.951
[1]   58.000    4.641 3690.930    0.001 2806.266
[1]   59.000    4.638 3724.975    0.001 2856.217
[1]   60.000    4.637 3781.765    0.001 2940.441
[1]   61.000    4.635 3866.795    0.001 3055.599
[1]   62.000    4.636 3903.929    0.002 3088.765
[1]   63.000    4.638 3945.442    0.003 3115.408
[1]   64.000    4.641 4004.385    0.001 3241.573
[1]   65.000    4.642 4051.618    0.001 3308.818
[1]   66.000    4.642 4095.464    0.001 3382.052
[1]   67.000    4.643 4129.916    0.001 3436.073
[1]   68.000    4.648 4151.986    0.002 3437.865
[1]   69.000    4.651 4205.644    0.001 3543.132
[1]   70.000    4.656 4251.112    0.001 3602.389
[1]   71.000    4.655 4323.495    0.001 3730.830
[1]   72.000    4.653 4386.162    0.001 3837.266
[1]   73.000    4.652 4422.719    0.001 3904.821
[1]   74.000    4.657 4496.103    0.001 4035.502
[1]   75.000    4.658 4546.114    0.001 4130.315
[1]   76.000    4.664 4583.259    0.001 4179.356
[1]   77.000    4.665 4611.471    0.001 4225.742
[1]   78.000    4.665 4633.580    0.001 4249.373
[1]   79.000    4.663 4659.768    0.001 4302.068
[1]   80.000    4.654 4773.707    0.001 4524.538
[1]   81.000    4.655 4822.209    0.001 4609.714
[1]   82.000    4.653 4837.076    0.001 4640.056
[1]   83.000    4.655 4885.396    0.001 4729.952
[1]   84.000    4.659 4944.150    0.001 4838.479
[1]   85.000    4.659 4973.730    0.001 4907.615
[1]   86.000    4.660 5006.126    0.001 4979.430
[1]   87.000    4.659 5043.802    0.001 5051.377
[1]   88.000    4.658 5076.345    0.001 5135.184
[1]   89.000    4.656 5110.699    0.001 5210.182
[1]   90.000    4.656 5132.953    0.001 5256.075
[1]   91.000    4.654 5175.016    0.001 5337.604
[1]   92.000    4.656 5199.361    0.001 5385.545
[1]   93.000    4.660 5239.781    0.001 5484.440
[1]   94.000    4.660 5259.978    0.001 5530.596
[1]   95.000    4.660 5301.583    0.001 5611.169
[1]   96.000    4.658 5322.715    0.001 5659.398
[1]   97.000    4.656 5341.989    0.001 5702.156
[1]   98.000    4.657 5358.995    0.001 5733.195
[1]   99.000    4.658 5430.490    0.001 5901.380
[1]  100.000    4.657 5488.731    0.001 6046.251
[1]  101.000    4.658 5520.818    0.001 6117.595
[1]  102.000    4.658 5556.873    0.001 6213.939
[1]  103.000    4.658 5584.622    0.001 6283.366
[1]  104.000    4.659 5601.718    0.001 6320.599
[1]  105.000    4.660 5645.759    0.001 6430.317
[1]  106.000    4.657 5683.098    0.001 6529.718
[1]  107.000    4.657 5717.672    0.001 6630.772
[1]  108.000    4.657 5742.690    0.001 6699.267
[1]  109.000    4.656 5749.439    0.001 6713.884
[1]  110.000    4.657 5765.868    0.001 6760.834
[1]  111.000    4.657 5785.381    0.001 6818.737
[1]  112.000    4.657 5813.419    0.001 6912.097
[1]  113.000    4.656 5839.131    0.001 6981.343
[1]  114.000    4.655 5868.635    0.000 7076.332
[1]  115.000    4.656 5903.180    0.000 7179.898
[1]  116.000    4.657 5942.501    0.000 7300.007
[1]  117.000    4.660 5969.275    0.001 7371.220
[1]  118.000    4.660 5982.195    0.000 7422.219
[1]  119.000    4.661 6016.999    0.001 7524.400
[1]  120.000    4.659 6055.295    0.000 7650.463
[1]  121.000    4.661 6083.088    0.000 7740.694
[1]  122.000    4.661 6099.476    0.000 7788.683
[1]  123.000    4.663 6129.974    0.000 7897.771
[1]  124.000    4.664 6160.272    0.000 7996.922
[1]  125.000    4.662 6179.255    0.000 8061.674
[1]  126.000    4.659 6225.051    0.000 8226.867
[1]  127.000    4.660 6256.267    0.000 8326.620
[1]  128.000    4.661 6308.687    0.000 8523.933
[1]  129.000    4.662 6324.827    0.001 8565.163
> 
> # Unique parameter sets
> n_unique <- length(unique(l_fit_imis$resample[,1])) # 6299
> # Effective sample size
> n_ess <- round(sum(table(l_fit_imis$resample[,1]))^2/ sum(table(l_fit_imis$resample[,1])^2), 0) # 4568
> # Max weight
> n_max_wt <- max(table(l_fit_imis$resample[,1]))/sum(table(l_fit_imis$resample[,1])) # 0.0009
> 
> # Calibration stats
> df_cali_stats <- data.frame(n_unique, n_ess, n_max_wt)
> df_cali_stats
  n_unique n_ess n_max_wt
1     6299  4586    9e-04
> 
> ### Save calibration stats
> ## As .RData
> save(df_cali_stats, 
+      file = "outputs/Calibration/cali_stats.RData")
> ## As .csv
> write.csv(df_cali_stats, 
+           file = "outputs/Calibration/cali_stats.csv", 
+           row.names = FALSE)