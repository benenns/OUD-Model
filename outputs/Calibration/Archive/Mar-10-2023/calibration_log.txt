> #### Run IMIS algorithm ####
> l_fit_imis <- IMIS(B = 100,      # n_samp = B*10 (was 100 incremental sample size at each iteration of IMIS)
+                    B.re = n_resamp,      # "n_resamp" desired posterior sample size
+                    number_k = 500,      # maximum number of iterations in IMIS (originally 10)
+                    D = 0) # originally 0
[1] "1000 likelihoods are evaluated in 28.4 minutes"
[1] "Stage   MargLike   UniquePoint   MaxWeight   ESS"
[1]  1.000  1.066 42.511  0.307  5.741
[1]  2.000  0.641 67.284  0.329  6.227
[1]  3.000  0.129 97.998  0.157 13.531
[1]   4.000   0.175 110.054   0.161  13.973
[1]   5.000   0.131 147.043   0.128  17.563
[1]   6.000  -0.006 179.437   0.145  20.515
[1]   7.000   0.413 188.562   0.174  14.660
[1]   8.000   0.387 211.809   0.147  19.612
[1]   9.000   0.138 267.948   0.101  32.600
[1]  10.000   0.078 291.588   0.090  41.632
[1]  11.000   0.523 309.830   0.260  11.090
[1]  12.000   0.164 367.440   0.181  23.205
[1]  13.000   0.156 418.896   0.096  46.875
[1]  14.000   0.192 455.047   0.054  63.775
[1]  15.000   0.346 475.368   0.143  33.051
[1]  16.000   0.230 533.753   0.039  85.898
[1]  17.000   0.225 563.084   0.037  92.336
[1]  18.000   0.172 583.484   0.038 100.656
[1]  19.000   0.128 634.535   0.039 117.796
[1]  20.000   0.084 663.070   0.031 134.087
[1]  21.000   0.149 685.317   0.062  99.607
[1]  22.000   0.230 707.625   0.048 104.631
[1]  23.000   0.194 760.270   0.036 144.162
[1]  24.000   0.333 783.814   0.087  71.961
[1]  25.000   0.298 858.354   0.042 150.914
[1]  26.000   0.441 877.370   0.050 113.415
[1]  27.000   0.480 925.338   0.085  79.957
[1]  28.000   0.433 990.018   0.042 166.674
[1]   29.000    0.395 1032.710    0.020  221.754
[1]   30.000    0.368 1064.818    0.020  235.843
[1]  31.000   0.965 939.139   0.421   5.606
[1]   32.000    0.459 1134.690    0.016  244.074
[1]   33.000    0.610 1157.131    0.063  139.872
[1]   34.000    0.552 1211.796    0.013  294.492
[1]   35.000    0.622 1257.295    0.015  297.865
[1]   36.000    0.646 1288.171    0.030  256.284
[1]   37.000    0.641 1318.424    0.014  323.467
[1]   38.000    0.653 1347.257    0.014  332.506
[1]   39.000    0.730 1354.568    0.047  198.056
[1]   40.000    0.700 1417.031    0.020  328.867
[1]   41.000    0.686 1441.164    0.012  370.818
[1]   42.000    0.792 1475.188    0.067  149.098
[1]   43.000    0.884 1476.483    0.090   83.697
[1]   44.000    0.796 1551.736    0.044  221.556
[1]   45.000    0.769 1615.619    0.024  363.547
[1]   46.000    0.748 1668.132    0.010  447.821
[1]   47.000    0.762 1676.434    0.012  442.240
[1]   48.000    0.798 1700.483    0.015  429.247
[1]   49.000    0.784 1737.283    0.009  468.080
[1]   50.000    0.860 1736.971    0.078  128.803
[1]   51.000    0.776 1806.287    0.010  493.609
[1]   52.000    0.796 1845.459    0.008  509.839
[1]   53.000    0.801 1874.037    0.011  518.422
[1]   54.000    0.812 1890.804    0.009  521.107
[1]   55.000    0.891 1868.473    0.079  128.229
[1]   56.000    0.802 1942.102    0.008  551.989
[1]   57.000    0.859 1944.078    0.059  201.468
[1]   58.000    0.805 1986.368    0.008  580.095
[1]   59.000    0.814 2026.566    0.007  601.555
[1]   60.000    0.827 2038.839    0.017  538.995
[1]   61.000    0.828 2064.278    0.008  605.592
[1]   62.000    0.986 1971.033    0.133   52.606
[1]   63.000    0.849 2087.332    0.016  543.871
[1]   64.000    0.854 2126.142    0.007  642.488
[1]   65.000    0.895 2129.439    0.031  410.105
[1]   66.000    0.877 2181.028    0.010  643.895
[1]   67.000    0.874 2211.495    0.006  680.411
[1]   68.000    0.895 2216.041    0.014  628.318
[1]   69.000    0.885 2239.953    0.006  705.123
[1]   70.000    0.910 2240.750    0.021  565.358
[1]   71.000    0.909 2269.625    0.011  676.922
[1]   72.000    0.903 2308.444    0.006  733.437
[1]   73.000    0.914 2350.313    0.007  749.191
[1]   74.000    0.931 2367.340    0.018  644.333
[1]   75.000    0.915 2419.330    0.006  802.646
[1]   76.000    0.913 2455.409    0.006  840.810
[1]   77.000    0.916 2475.021    0.006  869.476
[1]   78.000    0.960 2482.322    0.039  397.642
[1]   79.000    0.926 2544.880    0.005  915.730
[1]   80.000    0.924 2573.800    0.005  946.603
[1]   81.000    0.937 2571.518    0.009  880.468
[1]   82.000    0.938 2608.592    0.008  961.591
[1]   83.000    0.936 2644.350    0.006 1007.667
[1]   84.000    0.974 2657.482    0.021  742.031
[1]   85.000    0.969 2697.736    0.005 1047.109
[1]   86.000    0.978 2726.802    0.004 1073.668
[1]   87.000    0.976 2744.520    0.004 1090.980
[1]   88.000    0.972 2762.872    0.004 1122.558
[1]   89.000    0.992 2796.347    0.011 1023.734
[1]   90.000    0.986 2839.240    0.004 1166.593
[1]   91.000    0.995 2867.276    0.005 1177.300
[1]   92.000    1.012 2889.074    0.004 1186.861
[1]   93.000    1.013 2924.690    0.004 1219.551
[1]   94.000    1.024 2950.026    0.005 1223.372
[1]   95.000    1.027 2988.283    0.004 1281.287
[1]   96.000    1.026 3028.850    0.004 1328.077
[1]   97.000    1.036 3037.115    0.008 1245.664
[1]   98.000    1.040 3069.155    0.006 1303.085
[1]   99.000    1.046 3091.975    0.005 1328.669
[1]  100.000    1.066 3101.432    0.010 1238.360
[1]  101.000    1.258 2868.857    0.176   31.810
[1]  102.000    1.074 3145.530    0.004 1404.128
[1]  103.000    1.089 3141.840    0.011 1219.163
[1]  104.000    1.084 3174.673    0.003 1428.047
[1]  105.000    1.087 3208.945    0.003 1474.904
[1]  106.000    1.098 3227.600    0.004 1477.596
[1]  107.000    1.107 3240.481    0.003 1479.250
[1]  108.000    1.106 3259.522    0.003 1507.649
[1]  109.000    1.112 3270.107    0.005 1479.606
[1]  110.000    1.106 3289.595    0.003 1538.797
[1]  111.000    1.108 3322.946    0.003 1560.003
[1]  112.000    1.125 3343.035    0.010 1408.229
[1]  113.000    1.120 3392.399    0.003 1611.466
[1]  114.000    1.129 3424.077    0.003 1650.368
[1]  115.000    1.139 3440.063    0.007 1574.008
[1]  116.000    1.139 3458.045    0.004 1662.376
[1]  117.000    1.138 3464.881    0.003 1688.459
[1]  118.000    1.132 3491.465    0.003 1716.244
[1]  119.000    1.144 3500.870    0.005 1667.841
[1]  120.000    1.153 3529.242    0.005 1676.065
[1]  121.000    1.159 3535.266    0.009 1572.288
[1]  122.000    1.160 3565.122    0.003 1759.859
[1]  123.000    1.169 3580.405    0.003 1785.290
[1]  124.000    1.198 3560.303    0.023  925.619
[1]  125.000    1.175 3610.291    0.003 1805.333
[1]  126.000    1.178 3628.636    0.003 1839.113
[1]  127.000    1.177 3649.551    0.003 1864.580
[1]  128.000    1.182 3671.982    0.003 1900.302
[1]  129.000    1.182 3686.660    0.003 1927.898
[1]  130.000    1.189 3699.353    0.003 1947.828
[1]  131.000    1.206 3694.549    0.013 1525.299
[1]  132.000    1.214 3702.874    0.014 1449.119
[1]  133.000    1.205 3732.396    0.003 1961.216
[1]  134.000    1.213 3733.920    0.003 1940.725
[1]  135.000    1.216 3733.132    0.006 1846.715
[1]  136.000    1.237 3722.722    0.015 1403.662
[1]  137.000    1.231 3756.670    0.004 1947.213
[1]  138.000    1.253 3729.012    0.022 1039.553
[1]  139.000    1.252 3746.870    0.016 1350.446
[1]  140.000    1.252 3779.693    0.007 1859.145
[1]  141.000    1.249 3799.335    0.002 2029.057
[1]  142.000    1.257 3812.050    0.005 1985.465
[1]  143.000    1.268 3828.563    0.004 1991.387
[1]  144.000    1.260 3861.543    0.003 2082.275
[1]  145.000    1.266 3878.570    0.002 2102.903
[1]  146.000    1.277 3885.435    0.009 1842.931
[1]  147.000    1.266 3922.731    0.002 2147.563
[1]  148.000    1.267 3950.566    0.002 2193.100
[1]  149.000    1.265 3963.328    0.002 2220.106
[1]  150.000    1.280 3964.573    0.011 1774.265
[1]  151.000    1.273 3997.309    0.003 2228.762
[1]  152.000    1.357 3873.784    0.041  411.187
[1]  153.000    1.316 3971.862    0.019 1185.108
[1]  154.000    1.300 4028.092    0.007 1984.232
[1]  155.000    1.296 4057.062    0.003 2283.851
[1]  156.000    1.306 4063.079    0.008 2035.645
[1]  157.000    1.302 4092.069    0.004 2275.821
[1]  158.000    1.314 4096.897    0.005 2225.186
[1]  159.000    1.315 4118.376    0.004 2324.449
[1]  160.000    1.316 4128.373    0.004 2324.425
[1]  161.000    1.319 4134.836    0.007 2209.056
[1]  162.000    1.315 4170.413    0.003 2427.822
[1]  163.000    1.323 4182.012    0.003 2420.388
[1]  164.000    1.321 4200.363    0.002 2484.419
[1]  165.000    1.327 4220.611    0.002 2518.902
[1]  166.000    1.333 4234.181    0.002 2558.956
[1]  167.000    1.335 4244.033    0.002 2585.286
[1]  168.000    1.348 4234.815    0.008 2186.891
[1]  169.000    1.347 4275.254    0.002 2598.103
[1]  170.000    1.349 4295.685    0.002 2660.999
[1]  171.000    1.352 4314.318    0.002 2682.699
[1]  172.000    1.359 4327.868    0.003 2644.693
[1]  173.000    1.360 4339.001    0.002 2666.592
[1]  174.000    1.360 4354.335    0.002 2687.371
[1]  175.000    1.365 4374.402    0.002 2713.010
[1]  176.000    1.366 4400.921    0.002 2779.938
[1]  177.000    1.367 4409.797    0.002 2805.640
[1]  178.000    1.370 4428.301    0.002 2827.772
[1]  179.000    1.373 4440.431    0.002 2855.279
[1]  180.000    1.375 4450.131    0.002 2877.094
[1]  181.000    1.378 4460.825    0.003 2866.692
[1]  182.000    1.382 4473.116    0.002 2890.677
[1]  183.000    1.381 4485.826    0.002 2932.177
[1]  184.000    1.385 4505.190    0.002 2967.666
[1]  185.000    1.391 4515.504    0.002 2980.402
[1]  186.000    1.399 4521.012    0.005 2828.813
[1]  187.000    1.397 4542.220    0.002 3028.175
[1]  188.000    1.398 4558.075    0.002 3054.087
[1]  189.000    1.397 4566.400    0.002 3075.191
[1]  190.000    1.399 4574.433    0.002 3079.841
[1]  191.000    1.403 4592.226    0.002 3109.388
[1]  192.000    1.402 4617.941    0.001 3170.651
[1]  193.000    1.437 4549.704    0.031  780.559
[1]  194.000    1.407 4638.250    0.001 3197.264
[1]  195.000    1.408 4651.973    0.001 3226.035
[1]  196.000    1.408 4674.894    0.001 3265.270
[1]  197.000    1.413 4678.384    0.003 3201.632
[1]  198.000    1.420 4678.320    0.003 3108.896
[1]  199.000    1.423 4690.812    0.003 3140.757
[1]  200.000    1.422 4715.402    0.003 3248.879
[1]  201.000    1.420 4725.942    0.002 3320.078
[1]  202.000    1.423 4735.503    0.002 3324.803
[1]  203.000    1.424 4754.837    0.002 3389.032
[1]  204.000    1.425 4767.114    0.001 3411.124
[1]  205.000    1.431 4775.790    0.002 3380.130
[1]  206.000    1.432 4793.249    0.002 3433.536
[1]  207.000    1.440 4793.457    0.003 3285.705
[1]  208.000    1.442 4798.833    0.003 3344.916
[1]  209.000    1.438 4811.253    0.002 3445.841
[1]  210.000    1.480 4734.308    0.030  866.404
[1]  211.000    1.453 4815.765    0.002 3418.348
[1]  212.000    1.454 4824.684    0.003 3387.171
[1]  213.000    1.453 4837.478    0.002 3490.544
[1]  214.000    1.463 4831.295    0.006 3098.436
[1]  215.000    1.458 4869.624    0.002 3544.600
[1]  216.000    1.457 4877.899    0.001 3573.709
[1]  217.000    1.469 4871.035    0.008 2959.645
[1]  218.000    1.462 4901.658    0.002 3563.951
[1]  219.000    1.469 4910.120    0.006 3219.670
[1]  220.000    1.466 4941.977    0.001 3667.458
[1]  221.000    1.467 4947.606    0.001 3684.412
[1]  222.000    1.469 4960.787    0.001 3718.292
[1]  223.000    1.504 4883.908    0.021 1312.361
[1]  224.000    1.487 4949.839    0.006 3183.515
[1]  225.000    1.493 4967.215    0.004 3423.846
[1]  226.000    1.491 4995.332    0.003 3625.792
[1]  227.000    1.501 4998.813    0.006 3264.386
[1]  228.000    1.507 4991.887    0.010 2671.145
[1]  229.000    1.503 5021.648    0.002 3655.806
[1]  230.000    1.500 5041.053    0.002 3736.654
[1]  231.000    1.512 5038.738    0.005 3484.074
[1]  232.000    1.519 5040.380    0.008 3099.579
[1]  233.000    1.518 5065.021    0.004 3629.967
[1]  234.000    1.518 5073.555    0.002 3749.154
[1]  235.000    1.520 5088.096    0.002 3814.058
[1]  236.000    1.531 5077.520    0.007 3289.167
[1]  237.000    1.538 5081.017    0.005 3438.830
[1]  238.000    1.535 5100.278    0.004 3650.066
[1]  239.000    1.532 5113.663    0.003 3802.807
[1]  240.000    1.534 5132.988    0.002 3879.517
[1]  241.000    1.538 5145.774    0.003 3805.312
[1]  242.000    1.539 5168.183    0.002 3945.687
[1]  243.000    1.538 5183.685    0.002 3975.030
[1]  244.000    1.542 5203.799    0.002 4012.918
[1]  245.000    1.551 5204.473    0.004 3783.714
[1]  246.000    1.555 5222.448    0.002 3967.067
[1]  247.000    1.559 5236.720    0.002 3988.550
[1]  248.000    1.558 5259.085    0.002 4072.321
[1]  249.000    1.559 5278.417    0.002 4144.549
[1]  250.000    1.561 5295.193    0.002 4210.690
[1]  251.000    1.590 5236.123    0.021 1477.219
[1]  252.000    1.571 5309.547    0.002 4189.186
[1]  253.000    1.571 5328.327    0.001 4276.750
[1]  254.000    1.576 5322.956    0.005 3883.815
[1]  255.000    1.572 5347.689    0.001 4324.726
[1]  256.000    1.574 5357.105    0.001 4349.865
[1]  257.000    1.577 5364.511    0.002 4347.416
[1]  258.000    1.580 5384.446    0.001 4427.659
[1]  259.000    1.580 5405.942    0.001 4479.943
[1]  260.000    1.578 5425.178    0.001 4532.039
[1]  261.000    1.577 5431.628    0.001 4560.863
[1]  262.000    1.580 5438.176    0.001 4568.762
[1]  263.000    1.580 5445.084    0.001 4598.061
[1]  264.000    1.596 5419.452    0.004 3970.638
[1]  265.000    1.595 5443.915    0.004 4316.928
[1]  266.000    1.594 5459.560    0.002 4596.931
[1]  267.000    1.598 5474.571    0.002 4656.092
[1]  268.000    1.596 5493.647    0.001 4745.963
[1]  269.000    1.595 5507.067    0.001 4779.874
[1]  270.000    1.597 5516.587    0.001 4806.209
[1]  271.000    1.599 5533.645    0.002 4823.184
[1]  272.000    1.608 5518.421    0.006 4157.708
[1]  273.000    1.601 5544.308    0.002 4782.194
[1]  274.000    1.600 5570.325    0.001 4958.061
[1]  275.000    1.605 5577.754    0.002 4959.446
[1]  276.000    1.608 5587.013    0.002 4981.884
[1]  277.000    1.613 5581.803    0.004 4625.775
[1]  278.000    1.613 5609.570    0.001 5062.667
[1]  279.000    1.612 5614.907    0.001 5085.373
[1]  280.000    1.612 5630.121    0.001 5128.986
[1]  281.000    1.615 5648.071    0.001 5172.181
[1]  282.000    1.614 5657.141    0.001 5201.343
[1]  283.000    1.614 5665.359    0.001 5225.269
[1]  284.000    1.615 5666.874    0.001 5202.467
[1]  285.000    1.620 5669.945    0.003 5095.861
[1]  286.000    1.619 5696.209    0.001 5289.176
[1]  287.000    1.619 5706.966    0.001 5326.434
[1]  288.000    1.620 5721.042    0.001 5374.552
[1]  289.000    1.622 5719.167    0.002 5269.284
[1]  290.000    1.643 5663.990    0.015 2404.362
[1]  291.000    1.630 5723.079    0.004 4968.532
[1]  292.000    1.625 5742.126    0.001 5389.164
[1]  293.000    1.635 5727.842    0.007 4417.725
[1]  294.000    1.628 5761.877    0.001 5472.454
[1]  295.000    1.635 5770.254    0.001 5482.399
[1]  296.000    1.636 5785.541    0.001 5552.384
[1]  297.000    1.654 5734.777    0.016 2255.925
[1]  298.000    1.638 5791.803    0.001 5541.132
[1]  299.000    1.640 5797.660    0.001 5591.512
[1]  300.000    1.643 5802.262    0.001 5594.528
[1]  301.000    1.648 5799.251    0.003 5309.141
[1]  302.000    1.648 5809.150    0.002 5495.524
[1]  303.000    1.647 5823.184    0.001 5635.732
[1]  304.000    1.647 5830.848    0.001 5665.187
[1]  305.000    1.650 5827.794    0.002 5551.992
[1]  306.000    1.648 5844.582    0.001 5699.308
[1]  307.000    1.648 5854.409    0.001 5737.383
[1]  308.000    1.655 5856.029    0.002 5551.611
[1]  309.000    1.656 5878.415    0.002 5752.050
[1]  310.000    1.654 5894.933    0.001 5864.334
[1]  311.000    1.655 5900.554    0.001 5875.577
[1]  312.000    1.659 5902.788    0.002 5741.207
[1]  313.000    1.658 5915.837    0.001 5926.579
[1]  314.000    1.660 5922.948    0.002 5852.686
[1]  315.000    1.659 5933.342    0.001 5979.238
[1]  316.000    1.662 5939.172    0.001 5960.111
[1]  317.000    1.665 5946.734    0.001 6002.962
[1]  318.000    1.665 5953.593    0.001 6022.637
[1]  319.000    1.665 5964.971    0.001 6062.385
[1]  320.000    1.665 5975.093    0.001 6100.266
[1]  321.000    1.665 5979.324    0.001 6104.978
[1]  322.000    1.664 5985.711    0.001 6135.670
[1]  323.000    1.668 5982.880    0.001 6048.069
[1]  324.000    1.671 5988.642    0.002 6041.800
[1]  325.000    1.672 6001.847    0.001 6152.768
[1]  326.000    1.674 6005.839    0.001 6192.295
[1]  327.000    1.674 6025.156    0.001 6266.731
[1]  328.000    1.675 6035.843    0.001 6309.058
[1]  329.000    1.678 6045.851    0.001 6326.622
[1]  330.000    1.679 6059.667    0.001 6385.733
[1]  331.000    1.680 6071.156    0.001 6435.355
[1]  332.000    1.681 6077.367    0.001 6460.003
[1]  333.000    1.679 6089.996    0.001 6506.641
[1]  334.000    1.683 6083.169    0.004 5784.141
[1]  335.000    1.680 6105.077    0.001 6542.495
[1]  336.000    1.683 6113.139    0.001 6595.976
[1]  337.000    1.683 6121.380    0.001 6635.809
[1]  338.000    1.686 6131.586    0.001 6663.915
[1]  339.000    1.685 6140.556    0.001 6707.852
[1]  340.000    1.687 6146.404    0.001 6715.452
[1]  341.000    1.689 6153.871    0.002 6647.324
[1]  342.000    1.688 6165.958    0.001 6774.942
[1]  343.000    1.690 6176.747    0.001 6809.901
[1]  344.000    1.690 6191.184    0.001 6861.008
[1]  345.000    1.733 6031.286    0.042  525.533
[1]  346.000    1.693 6208.118    0.001 6902.320
[1]  347.000    1.697 6203.692    0.002 6690.262
[1]  348.000    1.695 6212.886    0.001 6879.039
[1]  349.000    1.696 6222.800    0.001 6940.737
[1]  350.000    1.698 6235.206    0.001 7001.186
[1]  351.000    1.698 6240.752    0.001 7032.759
[1]  352.000    1.699 6244.851    0.001 7053.124
[1]  353.000    1.700 6248.118    0.001 7033.796
[1]  354.000    1.701 6248.975    0.002 6984.632
[1]  355.000    1.703 6256.781    0.002 7003.873
[1]  356.000    1.702 6273.215    0.001 7139.022
[1]  357.000    1.709 6254.647    0.006 5627.987
[1]  358.000    1.709 6273.734    0.003 6844.980
[1]  359.000    1.707 6290.272    0.001 7190.625
[1]  360.000    1.708 6297.271    0.001 7223.960
[1]  361.000    1.710 6300.829    0.001 7234.058
[1]  362.000    1.713 6313.340    0.001 7265.436
[1]  363.000    1.714 6314.199    0.002 7198.383
[1]  364.000    1.718 6307.978    0.004 6678.823
[1]  365.000    1.716 6324.862    0.001 7289.889
> 
> # Unique parameter sets
> n_unique <- length(unique(l_fit_imis$resample[,1])) # 6299
> # Effective sample size
> n_ess <- round(sum(table(l_fit_imis$resample[,1]))^2/ sum(table(l_fit_imis$resample[,1])^2), 0) # 4568
> # Max weight
> n_max_wt <- max(table(l_fit_imis$resample[,1]))/sum(table(l_fit_imis$resample[,1])) # 0.0009
> 
> # Calibration stats
> df_cali_stats <- data.frame(n_unique, n_ess, n_max_wt)
> df_cali_stats
  n_unique n_ess n_max_wt
1     6326  4211   0.0014